{
    "collab_server" : "",
    "contents" : "data <- read.table(\n  \"data_JMP.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\ndata$year<-as.factor(data$year)\ndata$predator<-as.factor(data$predator)\nhead(data)\nstr(data)\n\n#Effects of traits on fitness - removing n_shoots, adding quadratic and interaction terms\nlibrary(car)\n\n#2010\n\n#Linear selection\n#Population=fixed\nmodelfr_10<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n                 predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n                 (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta,\n                 data=subset(data,year==2010))\nAnova(modelfr_10,type=\"II\")\n\nsummary(lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n             predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta,\n           data=subset(data,year==2010)))\n\n#Differences between \"/\" and \"%in%\"? --> I think \"%in%\" is the right one to use for nesting\n\n#Population=random\nlibrary(lmerTest)\nmodelfr_10<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n      predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n      (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta),\n      data = subset(data,year==2010),REML=F)\nsummary(modelfr_10)\nAnova(modelfr_10,type=\"II\")\n#But no significance tests for random factors!\n\n#Linear selection + interaction between traits\n#Population=fixed\nmodelfr_10_2<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n                   most_adv:n_fl+most_adv:h_shoot+n_fl:h_shoot+\n                 predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n                 (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta,\n               data=subset(data,year==2010))\nAnova(modelfr_10_2,type=\"II\")\n#None of the interactions is significant\n\n#Population=random\nmodelfr_10_2<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n             most_adv:n_fl+most_adv:h_shoot+n_fl:h_shoot+\n             predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n            (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta),\n            data = subset(data,year==2010),REML=F)\nsummary(modelfr_10_2)\nAnova(modelfr_10_2,type=\"II\")\n\n#Linear effects + quadratic effects\n#Population=fixed\nmost_adv_sta2<-I(subset(data,year==2010)$most_adv_sta^2)\nn_fl_sta2<-I(subset(data,year==2010)$n_fl_sta^2)\nh_shoot_sta2<-I(subset(data,year==2010)$h_shoot_sta^2)\n\nmodelfr_10_3<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n              most_adv_sta2+n_fl_sta2+h_shoot_sta2+\n              predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n              predator*most_adv_sta2+predator*n_fl_sta2+predator*h_shoot_sta2+\n              (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta+\n              (LokalID%in%predator):most_adv_sta2+(LokalID%in%predator):n_fl_sta2+(LokalID%in%predator):h_shoot_sta2,\n              data=subset(data,year==2010))\n  \nAnova(modelfr_10_3,type=\"II\")\n\n#Population=random\nmodelfr_10_3<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n              most_adv_sta2+n_fl_sta2+h_shoot_sta2+\n              predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n              predator*most_adv_sta2+predator*n_fl_sta2+predator*h_shoot_sta2+\n              (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta)+\n              (1|predator/LokalID:most_adv_sta2)+(1|predator/LokalID:n_fl_sta2)+(1|predator/LokalID:h_shoot_sta2),\n              data = subset(data,year==2010),REML=F,lmerControl(optimizer=\"bobyqa\", optCtrl = list(maxfun = 100000)))\nsummary(modelfr_10_3)\nAnova(modelfr_10_3,type=\"II\")\n\n\n#2011\n\n#Linear selection\n#Population=fixed\nmodelfr_11<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n                 predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n                 (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta,\n               data=subset(data,year==2011))\nAnova(modelfr_11,type=\"II\")\n\nsummary(lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n             predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta,\n           data=subset(data,year==2011)))\n\n#Differences between \"/\" and \"%in%\"? --> I think \"%in%\" is the right one to use for nesting\n\n#Population=random\nlibrary(lmerTest)\nmodelfr_11<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n                   predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n                   (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta),\n                 data = subset(data,year==2011),REML=F)\nsummary(modelfr_11)\nAnova(modelfr_11,type=\"II\")\n#But no significance tests for random factors!\n\n#Linear selection + interaction between traits\n#Population=fixed\nmodelfr_11_2<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n                   most_adv:n_fl+most_adv:h_shoot+n_fl:h_shoot+\n                   predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n                   (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta,\n                 data=subset(data,year==2011))\nAnova(modelfr_11_2,type=\"II\")\n#None of the interactions is significant\n\n#Population=random\nmodelfr_11_2<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n                     most_adv:n_fl+most_adv:h_shoot+n_fl:h_shoot+\n                     predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n                     (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta),\n                   data = subset(data,year==2011),REML=F)\nsummary(modelfr_11_2)\nAnova(modelfr_11_2,type=\"II\")\n\n#Linear effects + quadratic effects\n#Population=fixed\nmost_adv_sta2<-I(subset(data,year==2011)$most_adv_sta^2)\nn_fl_sta2<-I(subset(data,year==2011)$n_fl_sta^2)\nh_shoot_sta2<-I(subset(data,year==2011)$h_shoot_sta^2)\n\nmodelfr_11_3<-lm(n_intact_fruits_rel~most_adv_sta+n_fl_sta+h_shoot_sta+\n                   most_adv_sta2+n_fl_sta2+h_shoot_sta2+\n                   predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta+\n                   predator*most_adv_sta2+predator*n_fl_sta2+predator*h_shoot_sta2+\n                   (LokalID%in%predator):most_adv_sta+(LokalID%in%predator):n_fl_sta+(LokalID%in%predator):h_shoot_sta+\n                   (LokalID%in%predator):most_adv_sta2+(LokalID%in%predator):n_fl_sta2+(LokalID%in%predator):h_shoot_sta2,\n                 data=subset(data,year==2011))\n\nAnova(modelfr_11_3,type=\"II\")\n\n#Population=random\nmodelfr_11_3<-lmer(n_intact_fruits_rel ~ most_adv_sta+n_fl_sta+h_shoot_sta+\n                     most_adv_sta2+n_fl_sta2+h_shoot_sta2+\n                     predator*most_adv_sta+predator*n_fl_sta+predator*h_shoot_sta + \n                     predator*most_adv_sta2+predator*n_fl_sta2+predator*h_shoot_sta2+\n                     (1|predator/LokalID:most_adv_sta)+(1|predator/LokalID:n_fl_sta)+(1|predator/LokalID:h_shoot_sta)+\n                     (1|predator/LokalID:most_adv_sta2)+(1|predator/LokalID:n_fl_sta2)+(1|predator/LokalID:h_shoot_sta2),\n                   data = subset(data,year==2011),REML=F,lmerControl(optimizer=\"bobyqa\", optCtrl = list(maxfun = 100000)))\nsummary(modelfr_11_3)\nAnova(modelfr_11_3,type=\"II\")\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1472047275689.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1491913853",
    "id" : "9335D960",
    "lastKnownWriteTime" : 1426690481,
    "last_content_update" : 1426690481,
    "path" : "D:/SU/Projects/selection_flowering_phenology/code/Gentiana_phen_2010-2011/pop_nested_pred.R",
    "project_path" : "pop_nested_pred.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}