{
    "collab_server" : "",
    "contents" : "#2010\n#Read data\ndata10 <- read.table(\n  \"data1_2010.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(data10)\nsummary(data10)\nstr(data10)\n\n#Standardize  reproductive traits\n\nmean_n_intact_fruits<-aggregate(n_intact_fruits~LokalID, data10, mean )\nmean_n_seeds<-aggregate(n_seeds~LokalID, data10, mean )\n\ndata10<-merge(data10,mean_n_intact_fruits, by=\"LokalID\")\ndata10<-merge(data10,mean_n_seeds, by=\"LokalID\")\n\nhead(data10)\n\nmean_n_shoots<-aggregate(n_shoots~LokalID, data10, mean )\nmean_h_shoot<-aggregate(h_shoot~LokalID, data10, mean )\nmean_n_fl<-aggregate(n_fl~LokalID, data10, mean )\nmean_phen_index<-aggregate(phen_index~LokalID, data10, mean )\nmean_most_adv<-aggregate(most_adv~LokalID, data10, mean )\n\nsd_n_shoots<-aggregate(n_shoots~LokalID, data10, sd )\nsd_h_shoot<-aggregate(h_shoot~LokalID, data10, sd )\nsd_n_fl<-aggregate(n_fl~LokalID, data10, sd )\nsd_phen_index<-aggregate(phen_index~LokalID, data10, sd )\nsd_most_adv<-aggregate(most_adv~LokalID, data10, sd )\n\ndata10<-merge(data10,mean_n_shoots, by=\"LokalID\")\ndata10<-merge(data10,mean_h_shoot, by=\"LokalID\")\ndata10<-merge(data10,mean_n_fl, by=\"LokalID\")\ndata10<-merge(data10,mean_phen_index, by=\"LokalID\")\ndata10<-merge(data10,mean_most_adv, by=\"LokalID\")\n\nhead(data10)\nnames(data10)\n\nnames(data10)[5:9]<-c(\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\")\nnames(data10)[14:15]<-c(\"n_intact_fruits\",\"n_seeds\")\nnames(data10)[17:18]<-c(\"n_intact_fruits_mean\",\"n_seeds_mean\")\n\nnames(data10)[19:23]<-c(\"n_shoots_mean\",\"h_shoot_mean\",\"n_fl_mean\",\"phen_index_mean\",\"most_adv_mean\")\n\ndata10<-merge(data10,sd_n_shoots, by=\"LokalID\")\ndata10<-merge(data10,sd_h_shoot, by=\"LokalID\")\ndata10<-merge(data10,sd_n_fl, by=\"LokalID\")\ndata10<-merge(data10,sd_phen_index, by=\"LokalID\")\ndata10<-merge(data10,sd_most_adv, by=\"LokalID\")\n\nnames(data10)\nnames(data10)[5:9]<-c(\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\")\nnames(data10)[24:28]<-c(\"n_shoots_sd\",\"h_shoot_sd\",\"n_fl_sd\",\"phen_index_sd\",\"most_adv_sd\")\n\nnames(data10)\n\ndata10$n_shoots_sta<-(data10$n_shoots-data10$n_shoots_mean)/data10$n_shoots_sd\ndata10$h_shoot_sta<-(data10$h_shoot-data10$h_shoot_mean)/data10$h_shoot_sd\ndata10$n_fl_sta<-(data10$n_fl-data10$n_fl_mean)/data10$n_fl_sd\ndata10$phen_index_sta<-(data10$phen_index-data10$phen_index_mean)/data10$phen_index_sd\ndata10$most_adv_sta<-(data10$most_adv-data10$most_adv_mean)/data10$most_adv_sd\n\nsummary(data10,by=\"LokalID\")\naggregate(n_shoots_sta~LokalID, data10, sd )\naggregate(h_shoot_sta~LokalID, data10, sd )\naggregate(n_fl_sta~LokalID, data10, sd )\naggregate(phen_index_sta~LokalID, data10, sd )\naggregate(most_adv_sta~LokalID, data10, sd )\n\ndata10$n_intact_fruits_sta<-data10$n_intact_fruits/data10$n_intact_fruits_mean\ndata10$n_seeds_sta<-data10$n_seeds/data10$n_seeds_mean\n\nsummary(data10,by=\"LokalID\")\naggregate(n_intact_fruits_sta~LokalID, data10, sd )\naggregate(n_seeds_sta~LokalID, data10, sd )\n\nnames(data10)\n\ndata10sta<-data10[c(1:4,16,28:32,10:13,33,34)]\nhead(data10sta)\nnames(data10sta)<-c(\"LokalID\",\"predator\",\"Lokal\",\"Individ\",\"attack\",\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\",\n                    \"n_eggs\",\"n_pred_all\",\"n_aborted_all\",\"perc_undeveloped\",\"n_intact_fruits\",\"n_seeds\")\nsummary(data10sta,by=\"LokalID\")\n\n#Effects of traits on fitness\n\nmodelfr_10<-lm(n_intact_fruits~most_adv+n_fl+n_shoots+h_shoot+LokalID:most_adv+\n                 LokalID:n_fl+LokalID:n_shoots+LokalID:h_shoot,data=data10sta)\nlibrary(car)\nAnova(modelfr_10,type=\"II\")\n\nsummary(lm(n_intact_fruits~most_adv+n_fl+n_shoots+h_shoot,data=data10sta))\n\n#Linear selection gradients\n\nlibrary(lme4)\nlibrary(lattice)\n\ndata10staLokalID <- split(data10sta, data10sta$LokalID)\n\nlsel_fr_10 <- lapply(data10staLokalID, function (x) {\n  lm(n_intact_fruits ~ most_adv+n_fl+n_shoots+h_shoot, \n     data = x)\n})\n\nlsel_fr_10\n\nlselcoefs_fr_10 <- vector(\"list\", 20) # create list\n\nfor (i in 1:20)  #this is 20 LokalID\n{\n  lselcoefs_fr_10[[i]]<-summary(lsel_fr_10[[i]])$coefficients\n}\n\nnames(lselcoefs_fr_10)<-names(lsel_fr_10)\nlselcoefs_fr_10\nlselcoefs_fr_10<-do.call(\"rbind\",lapply(lselcoefs_fr_10,FUN=data.frame))\nlselcoefs_fr_10\n#Add asterisks for significance\nlselcoefs_fr_10$sig <- ifelse(lselcoefs_fr_10$Pr...t.. < 0.05,\"*\", \"\")\nhead(lselcoefs_fr_10)\nwrite.table(lselcoefs_fr_10,file=\"lselcoefs_fr_10_most_adv.txt\",sep=\"\\t\")\n\n#Differences in linear selection gradients between populations with/without predator\nlsel_grads_10 <- read.table(\n  \"lsel_grads_most_adv.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(lsel_grads_10)\nstr(lsel_grads_10)\nlsel_grads_10$pred<-as.factor(lsel_grads_10$pred)\n\npar(mfrow=c(1,2))\n\nsummary(lm(most_adv~pred,data=subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")))\nplot(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$pred,\n     subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$most_adv,\n     xlab=\"Predator\",ylab=\"Selection gradient for phenology\")\nlegend(\"topright\", legend =\"p =0.001\",bty = \"n\")\n\nlibrary(Rcmdr)\nsummary(lm(h_shoot~pred,data=subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")))\n\npar(mfrow=c(1,1),bty=\"l\",family=\"serif\",col=\"red\")\n\nplotMeans(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$most_adv,\n          subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$pred,\n          xlab=\"Predator\",ylab=\"Selection gradient for phenology\",main=NULL,\n          xlim=c(0.5,2.5),ylim=c(-0.3,0.4))\nlegend(\"top\", legend =\"p =0.001\",bty = \"n\")\n\nplotMeans(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$h_shoot,\n          subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\")$pred,\n          xlab=\"Predator\",ylab=\"Selection gradient for shoot height\")\nlegend(\"top\", legend = \"p = 0.750\",bty = \"n\")\n\n#Graphs with ggplot2\n\nscience_theme <- theme_bw(base_family = \"serif\")+theme(panel.grid.major = element_line(size = 0, color = \"white\"),\n   axis.line = element_line(size=.7, color = \"black\"), text = element_text(size=18),\n   axis.title.x = element_text(vjust=-0.50,size=18),axis.title.y = element_text(vjust=0.70,size=18),\n    axis.text.x=element_text(size=18),axis.text.y=element_text(size=18))+\n  theme( plot.background = element_blank() ,panel.grid.major = element_blank() ,\n         panel.grid.minor = element_blank() , panel.border = element_blank() ,\n         panel.background = element_blank() ) +  theme(axis.line = element_line(color = 'black'))\n\ndf1<-subset(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"))\ndf1\ndf1s <- summarySE(df1, measurevar=\"most_adv\", groupvars=c(\"pred\"))\ndf1s1 <- summarySE(df1, measurevar=\"h_shoot\", groupvars=c(\"pred\"))\n\nlibrary(ggplot2)\nggplot(df1s, aes(x=pred, y=most_adv)) + \n  geom_errorbar(aes(ymin=most_adv-se, ymax=most_adv+se), width=.1,size=.7) +\n  geom_line() +  geom_point(size=6)+science_theme+\n  labs(x = \"Predator\", y = \"Selection gradient for phenology\")\n\nggplot(df1s1, aes(x=pred, y=h_shoot)) + \n  geom_errorbar(aes(ymin=h_shoot-se, ymax=h_shoot+se), width=.1,size=.7) +\n  geom_line() +  geom_point(size=6)+science_theme+\n  labs(x = \"Predator\", y = \"Selection gradient for shoot height\")\n\n#Relation of linear selection gradients with intensity of predation (in populations with predator)\ndata10_pred<-subset(data10,predator==1)\ndata10_pred$LokalID<-factor(data10_pred$LokalID)\ndata10_npred<-subset(data10,predator==0)\ndata10_npred$LokalID<-factor(data10_npred$LokalID)\n\nas.data.frame(tapply(data10_pred$n_eggs, data10_pred$LokalID, mean))\n\ndata10_pred_means <- aggregate(data10_pred[,c(\"n_eggs\"), \n                     drop=FALSE],by=list(LokalID=data10_pred$LokalID), FUN=mean)\nsummary(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv~\n             data10_pred_means$n_eggs))\nplot(data10_pred_means$n_eggs,\n     subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for phenology\")\nabline(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv~\n            data10_pred_means$n_eggs))\nlegend(\"topright\", legend = \"R2 = 0.001; p = 0.846\",bty = \"n\")\n\nsummary(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl~\n             data10_pred_means$n_eggs))\npar(mfrow=c(1,2),family=\"serif\",pch=20,bty = \"l\")\nplot(data10_pred_means$n_eggs,subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for flower number\")\nabline(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl~ data10_pred_means$n_eggs))\nlegend(\"topright\", legend = \"R2 =  0.583, p = 0.006\",bty = \"n\")\n\nsummary(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot~\n             data10_pred_means$n_eggs))\nplot(data10_pred_means$n_eggs,subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for h_shoot\",\n     main=\"Fitness=n_intact_fruits\")\nabline(lm(subset(lsel_grads_10,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot~ data10_pred_means$n_eggs))\nlegend(\"topright\", legend = \"p = 0.102\",bty = \"n\")\n\n#Effects of traits on interaction intensity\n\nint1_10<-lm(n_eggs~most_adv+n_fl+n_shoots+h_shoot+LokalID*most_adv+\n              LokalID*n_fl+LokalID*n_shoots+LokalID*h_shoot,data=subset(data10sta,predator==1))\nAnova(int1_10,type=\"II\")\n\nAnova(lm(attack~most_adv+n_fl+n_shoots+h_shoot+LokalID*most_adv+\n              LokalID*n_fl+LokalID*n_shoots+LokalID*h_shoot,data=subset(data10sta,predator==1)),type=\"II\")\n\n#Effects of traits on interaction intensity: models for each population\n\ndata10sta_pred<-subset(data10sta,predator==1)\nlevels(data10sta_pred$LokalID)\ndata10sta_pred$LokalID <- factor(data10sta_pred$LokalID)\nlevels(data10sta_pred$LokalID)\n\ndata10sta_predLokalID <- split(data10sta_pred, data10sta_pred$LokalID)\n\nint_1_10_pops <- lapply(data10sta_predLokalID, function (x) {\n  lm(n_eggs ~ most_adv+n_fl+n_shoots+h_shoot, \n     data = x)\n})\n\nint_1_10_pops\n\nint_1_10_pops_coefs <- vector(\"list\", 11) # create list\n\nfor (i in 1:11)  #this is 11 LokalID\n{\n  int_1_10_pops_coefs[[i]]<-summary(int_1_10_pops[[i]])$coefficients\n}\n\nnames(int_1_10_pops_coefs)<-names(int_1_10_pops)\nint_1_10_pops_coefs\nint_1_10_pops_coefs<-do.call(\"rbind\",lapply(int_1_10_pops_coefs,FUN=data.frame))\nint_1_10_pops_coefs\n#Add asterisks for significance\nint_1_10_pops_coefs$sig <- ifelse(int_1_10_pops_coefs$Pr...t.. < 0.05,\"*\", \"\")\nhead(int_1_10_pops_coefs)\nwrite.table(int_1_10_pops_coefs,file=\"int_1_10_pops_coefs.txt\",sep=\"\\t\")\n\n##Effects of traits on interaction intensity: graphs for each population\nhead(data10_pred)\nstr(data10_pred)\n\n#2010\n\nxyplot(n_eggs ~ phen_index|LokalID, data = data10_pred, \n       auto.key = list(corner = c(0, .98)), cex = 1.5)\n\nlibrary(ggplot2)\n\nscience_theme = theme_bw(base_family = \"serif\")+theme(panel.grid.major = element_line(size = 0, color = \"white\"),\n  axis.line = element_line(size=.7, color = \"black\"), text = element_text(size=16),\n  axis.title.x = element_text(vjust=-0.50),axis.title.y = element_text(vjust=0.70))+\n  theme( plot.background = element_blank() ,panel.grid.major = element_blank() ,\n  panel.grid.minor = element_blank() , panel.border = element_blank() ,\n  panel.background = element_blank() ) +  theme(axis.line = element_line(color = 'black'))\n\ncbbPalette <- c(\"#000000\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \"#D55E00\", \"#CC79A7\",\"#CC6666\", \"#9999CC\", \"#66CC99\")\n\nggplot(data10_pred, aes(x=most_adv, y=attack,color=LokalID)) +\n  geom_smooth(method=lm, se=FALSE, size=0.7,fullrange=T)+ \n  scale_x_continuous(breaks=c(0,1,2,3,4,5,6))+\n  labs(x = \"Phenology (early flowering)\", y = \"Attack\")+\n  science_theme+scale_colour_manual(values=cbbPalette)\n\nggplot(data10_pred, aes(x=most_adv, y=n_eggs,color=LokalID)) +\n  geom_smooth(method=lm, se=FALSE, size=0.7,fullrange=T)+ \n  scale_x_continuous(breaks=c(0,1,2,3,4,5,6))+\n  labs(x = \"Phenology (early flowering)\", y = \"Number of eggs\")+\n  science_theme+scale_colour_manual(values=cbbPalette)\n\n#Significance?\nphen10 <- lapply(data10sta_predLokalID, function (x) {\n  lm(n_eggs ~ most_adv, \n     data = x)\n})\n\nphen10coefs<-vector(\"list\", 11) # create list\n\nfor (i in 1:11)  #this is 11 LokalID\n{\n  phen10coefs[[i]]<-summary(phen10[[i]])$coefficients\n}\n\nphen10coefs\n\nnames(phen10coefs)<-names(phen10)\nphen10coefs\nphen10coefs<-do.call(\"rbind\",lapply(phen10coefs,FUN=data.frame))\nphen10coefs\n#Add asterisks for significance\nphen10coefs$sig <- ifelse(phen10coefs$Pr...t.. < 0.05,\"*\", \"\")\nphen10coefs\n\n\n#2011\n#Read data\ndata11 <- read.table(\n  \"data1_2011.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(data11)\nsummary(data11)\nstr(data11)\n\n#Standardize  reproductive traits\n\nmean_n_intact_fruits<-aggregate(n_intact_fruits~LokalID, data11, mean )\nmean_n_seeds<-aggregate(n_seeds~LokalID, data11, mean )\n\ndata11<-merge(data11,mean_n_intact_fruits, by=\"LokalID\")\ndata11<-merge(data11,mean_n_seeds, by=\"LokalID\")\n\nhead(data11)\n\nmean_n_shoots<-aggregate(n_shoots~LokalID, data11, mean )\nmean_h_shoot<-aggregate(h_shoot~LokalID, data11, mean )\nmean_n_fl<-aggregate(n_fl~LokalID, data11, mean )\nmean_phen_index<-aggregate(phen_index~LokalID, data11, mean )\nmean_most_adv<-aggregate(most_adv~LokalID, data11, mean )\n\nsd_n_shoots<-aggregate(n_shoots~LokalID, data11, sd )\nsd_h_shoot<-aggregate(h_shoot~LokalID, data11, sd )\nsd_n_fl<-aggregate(n_fl~LokalID, data11, sd )\nsd_phen_index<-aggregate(phen_index~LokalID, data11, sd )\nsd_most_adv<-aggregate(most_adv~LokalID, data11, sd )\n\ndata11<-merge(data11,mean_n_shoots, by=\"LokalID\")\ndata11<-merge(data11,mean_h_shoot, by=\"LokalID\")\ndata11<-merge(data11,mean_n_fl, by=\"LokalID\")\ndata11<-merge(data11,mean_phen_index, by=\"LokalID\")\ndata11<-merge(data11,mean_most_adv, by=\"LokalID\")\n\nhead(data11)\nnames(data11)\n\nnames(data11)[5:9]<-c(\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\")\nnames(data11)[14:17]<-c(\"n_intact_fruits\",\"n_seeds\",\"n_intact_fruits_mean\",\"n_seeds_mean\")\nnames(data11)[18:22]<-c(\"n_shoots_mean\",\"h_shoot_mean\",\"n_fl_mean\",\"phen_index_mean\",\"most_adv_mean\")\n\ndata11<-merge(data11,sd_n_shoots, by=\"LokalID\")\ndata11<-merge(data11,sd_h_shoot, by=\"LokalID\")\ndata11<-merge(data11,sd_n_fl, by=\"LokalID\")\ndata11<-merge(data11,sd_phen_index, by=\"LokalID\")\ndata11<-merge(data11,sd_most_adv, by=\"LokalID\")\n\nnames(data11)\nnames(data11)[5:9]<-c(\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\")\nnames(data11)[23:27]<-c(\"n_shoots_sd\",\"h_shoot_sd\",\"n_fl_sd\",\"phen_index_sd\",\"most_adv_sd\")\n\nnames(data11)\n\ndata11$n_shoots_sta<-(data11$n_shoots-data11$n_shoots_mean)/data11$n_shoots_sd\ndata11$h_shoot_sta<-(data11$h_shoot-data11$h_shoot_mean)/data11$h_shoot_sd\ndata11$n_fl_sta<-(data11$n_fl-data11$n_fl_mean)/data11$n_fl_sd\ndata11$phen_index_sta<-(data11$phen_index-data11$phen_index_mean)/data11$phen_index_sd\ndata11$most_adv_sta<-(data11$most_adv-data11$most_adv_mean)/data11$most_adv_sd\n\nsummary(data11,by=\"LokalID\")\naggregate(n_shoots_sta~LokalID, data11, sd )\naggregate(h_shoot_sta~LokalID, data11, sd )\naggregate(n_fl_sta~LokalID, data11, sd )\naggregate(phen_index_sta~LokalID, data11, sd )\naggregate(most_adv_sta~LokalID, data11, sd )\n\ndata11$n_intact_fruits_sta<-data11$n_intact_fruits/data11$n_intact_fruits_mean\ndata11$n_seeds_sta<-data11$n_seeds/data11$n_seeds_mean\n\n\nsummary(data11,by=\"LokalID\")\naggregate(n_intact_fruits_sta~LokalID, data11, sd )\naggregate(n_seeds_sta~LokalID, data11, sd )\n\nnames(data11)\n\ndata11sta<-data11[c(1:4,28:32,10:13,33,34)]\nhead(data11sta)\nnames(data11sta)<-c(\"LokalID\",\"predator\",\"Lokal\",\"Individ\",\"n_shoots\",\"h_shoot\",\"n_fl\",\"phen_index\",\"most_adv\",\n                    \"n_eggs\",\"n_pred_all\",\"n_aborted_all\",\"perc_undeveloped\",\"n_intact_fruits\",\"n_seeds\")\nsummary(data11sta,by=\"LokalID\")\n\n#Effects of traits on fitness\n\nmodelfr1_11<-lm(n_intact_fruits~most_adv+n_fl+n_shoots+h_shoot+LokalID:most_adv+\n                  LokalID:n_fl+LokalID:n_shoots+LokalID:h_shoot,data=data11sta)\nAnova(modelfr1_11,type=\"II\")\n\n#Linear selection gradients\n\nlibrary(lme4)\nlibrary(lattice)\n\ndata11staLokalID <- split(data11sta, data11sta$LokalID)\n\nlsel_fr_11 <- lapply(data11staLokalID, function (x) {\n  lm(n_intact_fruits ~ phen_index+n_fl+n_shoots+h_shoot, \n     data = x)\n})\n\nlsel_fr_11\n\nlselcoefs_fr_11 <- vector(\"list\", 16) # create list\n\nfor (i in 1:16)  #this is 16 LokalID\n{\n  lselcoefs_fr_11[[i]]<-summary(lsel_fr_11[[i]])$coefficients\n}\n\nnames(lselcoefs_fr_11)<-names(lsel_fr_11)\nlselcoefs_fr_11\nlselcoefs_fr_11<-do.call(\"rbind\",lapply(lselcoefs_fr_11,FUN=data.frame))\nlselcoefs_fr_11\n#Add asterisks for significance\nlselcoefs_fr_11$sig <- ifelse(lselcoefs_fr_11$Pr...t.. < 0.05,\"*\", \"\")\nhead(lselcoefs_fr_11)\nwrite.table(lselcoefs_fr_11,file=\"lselcoefs_fr_11.txt\",sep=\"\\t\")\n\n#Differences in linear selection gradients between populations with/without predator\nlsel_grads_11 <- read.table(\n  \"lsel_grads_11_most_adv.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(lsel_grads_11)\nstr(lsel_grads_11)\nlsel_grads_11$pred<-as.factor(lsel_grads_11$pred)\n\npar(mfrow=c(1,1),bty=\"l\",family=\"serif\",col=\"blue\")\n\nsummary(lm(most_adv~pred,data=subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")))\nplot(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$pred,\n     subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$most_adv,\n     xlab=\"Predator\",ylab=\"Selection gradient for most_adv\",\n     main=\"Fitness=n_intact_fruits\")\nlegend(\"topright\", legend = \"p < 0.001\",bty = \"n\")\n\nlibrary(Rcmdr)\nplotMeans(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$most_adv,\n          subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$pred,\n          xlab=\"Predator\",ylab=\"Selection gradient for phenology\",main=NULL,\n          xlim=c(0.5,2.5),ylim=c(-0.3,0.4))\nlegend(\"top\", legend =\"p <0.001\",bty = \"n\")\n\nplotMeans(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$h_shoot,\n          subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$pred,\n          xlab=\"Predator\",ylab=\"Selection gradient for shoot height\")\nlegend(\"top\", legend = \"p = 0.040\",bty = \"n\")\n\nsummary(lm(h_shoot~pred,data=subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")))\nplot(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$pred,\n     subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$h_shoot,\n     xlab=\"Predator\",ylab=\"Selection gradient for h_shoot\",\n     main=\"Fitness=n_intact_fruits\")\nlegend(\"topright\", legend = \"p = 0.0395\",bty = \"n\")\n\nplotMeans(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$h_shoot,\n          subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\")$pred,\n          xlab=\"Predator\",ylab=\"Selection gradient for v\",\n          main=\"Fitness=n_intact_fruits\")\nlegend(\"topright\", legend = \"p = 0.0395\",bty = \"n\")\n\n#Graphs with ggplot2\n\ndf2<-subset(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"))\ndf2\ndf2s <- summarySE(df2, measurevar=\"most_adv\", groupvars=c(\"pred\"))\ndf2s1 <- summarySE(df2, measurevar=\"h_shoot\", groupvars=c(\"pred\"))\n\nggplot(df2s, aes(x=pred, y=most_adv)) + \n  geom_errorbar(aes(ymin=most_adv-se, ymax=most_adv+se), width=.1,size=.7) +\n  geom_line() +  geom_point(size=6)+science_theme+\n  labs(x = \"Predator\", y = \"Selection gradient for phenology\")\n\nggplot(df2s1, aes(x=pred, y=h_shoot)) + \n  geom_errorbar(aes(ymin=h_shoot-se, ymax=h_shoot+se), width=.1,size=.7) +\n  geom_line() +  geom_point(size=6)+science_theme+\n  labs(x = \"Predator\", y = \"Selection gradient for shoot height\")\n\n#Relation of linear selection gradients with intensity of predation (in populations with predator)\ndata11_pred<-subset(data11,Predator==1)\ndata11_pred$LokalID<-factor(data11_pred$LokalID)\ndata11_npred<-subset(data11,Predator==0)\ndata11_npred$LokalID<-factor(data11_npred$LokalID)\n\nas.data.frame(tapply(data11_pred$n_eggs, data11_pred$LokalID, mean))\n\ndata11_pred_means <- aggregate(data11_pred[,c(\"n_aborted_all\",\"n_eggs\",\"n_pred_all\"), \n                                           drop=FALSE],by=list(LokalID=data11_pred$LokalID), FUN=mean)\n\nsummary(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv~\n             data11_pred_means$n_eggs))\nplot(data11_pred_means$n_eggs,\n     subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for phenology\")\nabline(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$most_adv~\n            data11_pred_means$n_eggs))\nlegend(\"topright\", legend = \"R2 = 0.265; p = 0.105\",bty = \"n\")\n\nsummary(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl~\n             data11_pred_means$n_eggs))\npar(mfrow=c(1,2),family=\"serif\",pch=20,bty = \"l\")\n\nplot(data11_pred_means$n_eggs,subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for flower number\")\nabline(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl~ data11_pred_means$n_eggs))\nlegend(\"topright\", legend = \"R2 = 0.166; p = 0.214\",bty = \"n\")\n\nplot(data11_pred_means$n_eggs,subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for n_fl\",\n     main=\"Fitness=n_intact_fruits\")\nabline(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$n_fl~ data11_pred_means$n_eggs))\n\nsummary(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot~\n             data11_pred_means$n_eggs))\npar(mfrow=c(1,2))\nplot(data11_pred_means$n_eggs,subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot,\n     xlab=\"Mean number of eggs\",ylab=\"Selection gradient for h_shoot\",\n     main=\"Fitness=n_intact_fruits\")\nabline(lm(subset(lsel_grads_11,fitness_measure==\"n_intact_fruits\"&pred==1)$h_shoot~ data11_pred_means$n_eggs))\n\n#Effects of traits on interaction intensity\n\nint1_11<-lm(n_eggs~most_adv+n_fl+n_shoots+h_shoot+LokalID*most_adv+\n              LokalID*n_fl+LokalID*n_shoots+LokalID*h_shoot,data=subset(data11sta,predator==1))\nAnova(int1_11,type=\"II\")\n\n#Effects of traits on interaction intensity: models for each population\n\ndata11sta_pred<-subset(data11sta,predator==1)\nlevels(data11sta_pred$LokalID)\ndata11sta_pred$LokalID <- factor(data11sta_pred$LokalID)\nlevels(data11sta_pred$LokalID)\n\ndata11sta_predLokalID <- split(data11sta_pred, data11sta_pred$LokalID)\n\nint_1_11_pops <- lapply(data11sta_predLokalID, function (x) {\n  lm(n_eggs ~ most_adv+n_fl+n_shoots+h_shoot, \n     data = x)\n})\n\nint_1_11_pops\n\nint_1_11_pops_coefs <- vector(\"list\", 11) # create list\n\nfor (i in 1:11)  #this is 11 LokalID\n{\n  int_1_11_pops_coefs[[i]]<-summary(int_1_11_pops[[i]])$coefficients\n}\n\nnames(int_1_11_pops_coefs)<-names(int_1_11_pops)\nint_1_11_pops_coefs\nint_1_11_pops_coefs<-do.call(\"rbind\",lapply(int_1_11_pops_coefs,FUN=data.frame))\nint_1_11_pops_coefs\n#Add asterisks for significance\nint_1_11_pops_coefs$sig <- ifelse(int_1_11_pops_coefs$Pr...t.. < 0.05,\"*\", \"\")\nhead(int_1_11_pops_coefs)\nwrite.table(int_1_11_pops_coefs,file=\"int_1_11_pops_coefs.txt\",sep=\"\\t\")\n\n##Effects of traits on interaction intensity: graphs for each population\n#2011\n\nggplot(data11_pred, aes(x=phen_index, y=n_eggs,color=LokalID)) +\n  geom_smooth(method=lm, se=FALSE, size=0.7,fullrange=T)+\n  scale_x_continuous(breaks=c(0,1,2,3,4,5,6))+\n  labs(x = \"Phenology index\", y = \"Number of eggs\")+\n  science_theme+scale_colour_manual(values=cbbPalette)\n\nggplot(data11_pred, aes(x=most_adv, y=n_eggs,color=LokalID)) +\n  geom_smooth(method=lm, se=FALSE, size=1,fullrange=T)+ \n  scale_x_continuous(breaks=c(0,1,2,3,4,5,6))+\n  labs(x = \"Most advanced bud\", y = \"Number of eggs\")+\n  science_theme+scale_colour_manual(values=cbbPalette)\n\n#Significance?\n#2011\nphen11 <- lapply(data11sta_predLokalID, function (x) {\n  lm(n_eggs ~ most_adv, \n     data = x)\n})\n\nphen11coefs<-vector(\"list\", 11) # create list\n\nfor (i in 1:11)  #this is 11 LokalID\n{\n  phen11coefs[[i]]<-summary(phen11[[i]])$coefficients\n}\n\nphen11coefs\n\nnames(phen11coefs)<-names(phen11)\nphen11coefs\nphen11coefs<-do.call(\"rbind\",lapply(phen11coefs,FUN=data.frame))\nphen11coefs\n#Add asterisks for significance\nphen11coefs$sig <- ifelse(phen11coefs$Pr...t.. < 0.05,\"*\", \"\")\nphen11coefs\n\n#Ants\n#Read data\nants_mean_max <- read.table(\n  \"ants_mean_max.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\n\nants_mean_max\nstr(ants_mean_max)\n\nants_mean_max$logants<-log(ants_mean_max$ants_max+0.025)\nlogistic<-glm(pred~logants,data=ants_mean_max,family=binomial)\nsummary(logistic)\npar(mfrow=c(1,1),family=\"serif\")\nplot(ants_mean_max$logants,ants_mean_max$pred,xlab=\"Myrmica abundance (log)\",ylab=\"M. alcon presence\",bty=\"l\",pch=20,family=\"serif\")\ncurve(predict(logistic, data.frame(logants=x), type=\"resp\"), add=TRUE) \nlegend(\"topleft\", legend = \"p = 0.045\",bty = \"n\") \n\nants_mean_max$LokalID<-ants_mean_max$pop\nantstry<-merge(ants_mean_max,data10,by=\"LokalID\")\nantstry<-merge(ants_mean_max,data11,by=\"LokalID\")\n\nsummary(with(subset(antstry,pred==1),lm(n_eggs~logants)))     ###SIGNIF!! -but negative effect!\nwith(subset(antstry,pred==1),plot(logants,n_eggs))\nabline(with(subset(antstry,pred==1),lm(n_eggs~logants)))\nlogistic2<-glm(attack~logants,data=subset(antstry,pred==1),family=binomial)\nsummary(logistic2)\nwith(subset(antstry,pred==1),plot(logants,attack))\ncurve(predict(logistic2, data.frame(logants=x), type=\"resp\"), add=TRUE) \n\n###################################################################################\nants_intensity <- read.table(\n  \"ants_intensity.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nants_intensity\n\nsummary(lm(meaneggs~logants,data=subset(ants_intensity,year==2010)))\nsummary(lm(meaneggs~logants,data=subset(ants_intensity,year==2011)))\nsummary(lm(propattack~logants,data=subset(ants_intensity,year==2010)))\nsummary(lm(propattack~logants,data=subset(ants_intensity,year==2011)))               \n\n\npar(mfrow=c(1,1),col=\"black\",pch=20,family=\"serif\",bty=\"l\",cex=1.5,cex.axis=0.7,cex.lab=0.7)\nplot(ants_mean_max$logants,ants_mean_max$pred,xlab=\"Myrmica abundance (log)\",ylab=\"M. alcon presence\",bty=\"l\",pch=20,family=\"serif\")\ncurve(predict(logistic, data.frame(logants=x), type=\"resp\"), add=TRUE) \nlegend(\"topleft\", legend = \"p = 0.045\",bty = \"n\") \n\nwith(ants_intensity,plot(logants,meaneggs,col = c(\"black\",\"grey\")[as.factor(year)],\n     xlab=\"Myrmica abundance (log)\",ylab=\"Mean number of eggs\"))\nwith(ants_intensity,plot(logants,propattack,col = c(\"black\",\"grey\")[as.factor(year)],\n     xlab=\"Myrmica abundance (log)\",ylab=\"Proportion of plants attacked\"))\n###################################################################################\n\n#Do butterflies reduce fitness?\n#All pops\npar(mfrow=c(1,2))\n#2010\ndata10$predator<-as.factor(data10$predator)\nsummary(lm(n_intact_fruits~predator,data=data10))\nplotMeans(data10$n_intact_fruits,data10$predator)\n\n#2011\ndata11$Predator<-as.factor(data11$Predator)\nsummary(lm(n_intact_fruits~Predator,data=data11))\nplotMeans(data11$n_intact_fruits,data11$Predator)\n\n#Pops with predator\n#2010\nhead(data10_pred)\ndata10_pred$attacked<-ifelse(data10_pred$n_eggs==0,0,1)\n\nsummary(lm(n_intact_fruits~attacked,data=data10_pred))\nplotMeans(data10_pred$n_intact_fruits,data10_pred$attacked)\n\n#2011\nhead(data11_pred)\ndata11_pred$attacked<-ifelse(data11_pred$n_eggs==0,0,1)\n\nsummary(lm(n_intact_fruits~attacked,data=data11_pred))\nplotMeans(data11_pred$n_intact_fruits,data11_pred$attacked)\n\n#Within each population\n#2010\nwith(data10_pred,plotMeans(n_intact_fruits,attacked))\n\nlevels(data10_pred$LokalID)\n\npar(mfrow=c(2,3))\nwith(subset(data10_pred,LokalID==\"Ale001\"),plotMeans(n_intact_fruits,attacked,main=\"Ale001\"))\nwith(subset(data10_pred,LokalID==\"Göt009a\"),plotMeans(n_intact_fruits,attacked,main=\"Göt009a\"))\nwith(subset(data10_pred,LokalID==\"Göt009b\"),plotMeans(n_intact_fruits,attacked,main=\"Göt009b\"))\nwith(subset(data10_pred,LokalID==\"Göt016\"),plotMeans(n_intact_fruits,attacked,main=\"Göt016\"))\nwith(subset(data10_pred,LokalID==\"Her003\"),plotMeans(n_intact_fruits,attacked,main=\"Her003\"))\nwith(subset(data10_pred,LokalID==\"Her004\"),plotMeans(n_intact_fruits,attacked,main=\"Her004\"))\nwith(subset(data10_pred,LokalID==\"Her005\"),plotMeans(n_intact_fruits,attacked,main=\"Her005\"))\nwith(subset(data10_pred,LokalID==\"Ler010\"),plotMeans(n_intact_fruits,attacked,main=\"Ler010\"))\nwith(subset(data10_pred,LokalID==\"Par003\"),plotMeans(n_intact_fruits,attacked,main=\"Par003\"))\nwith(subset(data10_pred,LokalID==\"Vår004\"),plotMeans(n_intact_fruits,attacked,main=\"Vår004\"))\nwith(subset(data10_pred,LokalID==\"Vår009\"),plotMeans(n_intact_fruits,attacked,main=\"Vår009\"))\n\nwith(subset(data10_pred,LokalID==\"Ale001\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Göt009a\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Göt009b\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Göt016\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Her003\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Her004\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Her005\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Ler010\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Par003\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Vår004\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data10_pred,LokalID==\"Vår009\"),summary(lm(n_intact_fruits~attacked)))\n\nwith(subset(data10_pred,LokalID==\"Ale001\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Göt009a\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Göt009b\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Göt016\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Her003\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Her004\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Her005\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Ler010\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Par003\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Vår004\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data10_pred,LokalID==\"Vår009\"),summary(lm(n_intact_fruits~n_eggs)))\n\n#2011\nwith(data11_pred,plotMeans(n_intact_fruits,attacked))\n\nlevels(data11_pred$LokalID)\n\npar(mfrow=c(2,3))\nwith(subset(data11_pred,LokalID==\"Ale001\"),plotMeans(n_intact_fruits,attacked,main=\"Ale001\"))\nwith(subset(data11_pred,LokalID==\"Göt009a\"),plotMeans(n_intact_fruits,attacked,main=\"Göt009a\"))\nwith(subset(data11_pred,LokalID==\"Göt009b\"),plotMeans(n_intact_fruits,attacked,main=\"Göt009b\"))\nwith(subset(data11_pred,LokalID==\"Göt016\"),plotMeans(n_intact_fruits,attacked,main=\"Göt016\"))\nwith(subset(data11_pred,LokalID==\"Her003\"),plotMeans(n_intact_fruits,attacked,main=\"Her003\"))\nwith(subset(data11_pred,LokalID==\"Her004\"),plotMeans(n_intact_fruits,attacked,main=\"Her004\"))\nwith(subset(data11_pred,LokalID==\"Her005\"),plotMeans(n_intact_fruits,attacked,main=\"Her005\"))\nwith(subset(data11_pred,LokalID==\"Ler010\"),plotMeans(n_intact_fruits,attacked,main=\"Ler010\"))\nwith(subset(data11_pred,LokalID==\"Par003\"),plotMeans(n_intact_fruits,attacked,main=\"Par003\"))\nwith(subset(data11_pred,LokalID==\"Vår004\"),plotMeans(n_intact_fruits,attacked,main=\"Vår004\"))\nwith(subset(data11_pred,LokalID==\"Vår009\"),plotMeans(n_intact_fruits,attacked,main=\"Vår009\"))\n\nwith(subset(data11_pred,LokalID==\"Ale001\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Göt009a\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Göt009b\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Göt016\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Her003\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Her004\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Her005\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Ler010\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Par003\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Vår004\"),summary(lm(n_intact_fruits~attacked)))\nwith(subset(data11_pred,LokalID==\"Vår009\"),summary(lm(n_intact_fruits~attacked)))\n\nwith(subset(data11_pred,LokalID==\"Ale001\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Göt009a\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Göt009b\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Göt016\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Her003\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Her004\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Her005\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Ler010\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Par003\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Vår004\"),summary(lm(n_intact_fruits~n_eggs)))\nwith(subset(data11_pred,LokalID==\"Vår009\"),summary(lm(n_intact_fruits~n_eggs)))\n\n#Is probability of being attacked within populations with the predator associated with \n#flowering phenology? - Are early flowering plants more attacked than late flowering?\n#All pops\n#2010\nlogistic_10<-glm(attacked~most_adv,data=data10_pred,family=binomial)\nsummary(logistic_10)\nwith(data10_pred,plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"ALL\"))\ncurve(predict(logistic_10, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \n\n#2011\nlogistic_11<-glm(attacked~most_adv,data=data11_pred,family=binomial)\nsummary(logistic_11)\nwith(data11_pred,plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"ALL\"))\ncurve(predict(logistic_11, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \n\n#Within each population\n#2010\n\nlevels(data10_pred$LokalID)\n\nlogistic_10_Ale001<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Ale001\"),family=binomial)\nlogistic_10_Göt009a<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Göt009a\"),family=binomial)\nlogistic_10_Göt009b<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Göt009b\"),family=binomial)\nlogistic_10_Göt016<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Göt016\"),family=binomial)\nlogistic_10_Her003<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Her003\"),family=binomial)\nlogistic_10_Her004<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Her004\"),family=binomial)\nlogistic_10_Her005<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Her005\"),family=binomial)\nlogistic_10_Ler010<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Ler010\"),family=binomial)\nlogistic_10_Par003<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Par003\"),family=binomial)\nlogistic_10_Vår004<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Vår004\"),family=binomial)\nlogistic_10_Vår009<-glm(attacked~most_adv,data=subset(data10_pred,LokalID==\"Vår009\"),family=binomial)\n\npar(mfrow=c(2,3))\nwith(subset(data10_pred,LokalID==\"Ale001\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Ale001\"))\ncurve(predict(logistic_10_Ale001, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Göt009a\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt009a\"))\ncurve(predict(logistic_10_Göt009a, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Göt009b\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt009b\"))\ncurve(predict(logistic_10_Göt009b, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Göt016\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt016\"))\ncurve(predict(logistic_10_Göt016, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Her003\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her003\"))\ncurve(predict(logistic_10_Her003, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Her004\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her004\"))\ncurve(predict(logistic_10_Her004, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Her005\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her005\"))\ncurve(predict(logistic_10_Her005, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Ler010\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Ler010\"))\ncurve(predict(logistic_10_Ler010, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Par003\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Par003\"))\ncurve(predict(logistic_10_Par003, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Vår004\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Vår004\"))\ncurve(predict(logistic_10_Vår004, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data10_pred,LokalID==\"Vår009\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Vår009\"))\ncurve(predict(logistic_10_Vår009, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \n\nsummary(logistic_10_Ale001)\nsummary(logistic_10_Göt009a)\nsummary(logistic_10_Göt009b)\nsummary(logistic_10_Göt016)\nsummary(logistic_10_Her003)\nsummary(logistic_10_Her004)\nsummary(logistic_10_Her005)\nsummary(logistic_10_Ler010)\nsummary(logistic_10_Par003)\nsummary(logistic_10_Vår004)\nsummary(logistic_10_Vår009)\n\n#2011\n\nlevels(data11_pred$LokalID)\n\nlogistic_11_Ale001<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Ale001\"),family=binomial)\nlogistic_11_Göt009a<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Göt009a\"),family=binomial)\nlogistic_11_Göt009b<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Göt009b\"),family=binomial)\nlogistic_11_Göt016<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Göt016\"),family=binomial)\nlogistic_11_Her003<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Her003\"),family=binomial)\nlogistic_11_Her004<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Her004\"),family=binomial)\nlogistic_11_Her005<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Her005\"),family=binomial)\nlogistic_11_Ler010<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Ler010\"),family=binomial)\nlogistic_11_Par003<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Par003\"),family=binomial)\nlogistic_11_Vår004<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Vår004\"),family=binomial)\nlogistic_11_Vår009<-glm(attacked~most_adv,data=subset(data11_pred,LokalID==\"Vår009\"),family=binomial)\n\npar(mfrow=c(2,3))\nwith(subset(data11_pred,LokalID==\"Ale001\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Ale001\"))\ncurve(predict(logistic_11_Ale001, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Göt009a\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt009a\"))\ncurve(predict(logistic_11_Göt009a, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Göt009b\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt009b\"))\ncurve(predict(logistic_11_Göt009b, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Göt016\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Göt016\"))\ncurve(predict(logistic_11_Göt016, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Her003\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her003\"))\ncurve(predict(logistic_11_Her003, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Her004\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her004\"))\ncurve(predict(logistic_11_Her004, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Her005\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Her005\"))\ncurve(predict(logistic_11_Her005, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Ler010\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Ler010\"))\ncurve(predict(logistic_11_Ler010, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Par003\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Par003\"))\ncurve(predict(logistic_11_Par003, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Vår004\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Vår004\"))\ncurve(predict(logistic_11_Vår004, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \nwith(subset(data11_pred,LokalID==\"Vår009\"),plot(most_adv,attacked,xlab=\"Phenology\",ylab=\"Attacked\",main=\"Vår009\"))\ncurve(predict(logistic_11_Vår009, data.frame(most_adv=x), type=\"resp\"), add=TRUE) \n\nsummary(logistic_11_Ale001)\nsummary(logistic_11_Göt009a)\nsummary(logistic_11_Göt009b)\nsummary(logistic_11_Göt016)\nsummary(logistic_11_Her003)\nsummary(logistic_11_Her004)\nsummary(logistic_11_Her005)\nsummary(logistic_11_Ler010)\nsummary(logistic_11_Par003)\nsummary(logistic_11_Vår004)\nsummary(logistic_11_Vår009)\n\n############################################\nwith(data10_pred,summary(lm(n_intact_fruits~n_eggs)))\nwith(data10_pred,plot(n_eggs,n_intact_fruits))\nwith(data10_pred,abline(lm(n_intact_fruits~n_eggs)))\n\nwith(data11_pred,summary(lm(n_intact_fruits~n_eggs)))\nwith(data11_pred,plot(n_eggs,n_intact_fruits))\nwith(data11_pred,abline(lm(n_intact_fruits~n_eggs)))\n\ndata10_pred$most_adv<-as.numeric(data10_pred$most_adv)\nwith(data10_pred,summary(lm(n_eggs~most_adv)))\nwith(data10_pred,plot(most_adv,n_eggs))\nwith(data10_pred,abline(lm(n_eggs~most_adv)))\ndata10_pred$most_adv<-as.factor(data10_pred$most_adv)\nwith(data10_pred,plot(most_adv,n_eggs))\nwith(data10_pred,summary(lm(n_eggs~most_adv)))\n\ndata11_pred$most_adv<-as.numeric(data11_pred$most_adv)\nwith(data11_pred,summary(lm(n_eggs~most_adv)))\nwith(data11_pred,plot(most_adv,n_eggs))\nwith(data11_pred,abline(lm(n_eggs~most_adv)))\ndata11_pred$most_adv<-as.factor(data11_pred$most_adv)\nwith(data11_pred,plot(most_adv,n_eggs))\nwith(data11_pred,summary(lm(n_eggs~most_adv)))\n\n",
    "created" : 1473075205806.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2564171894",
    "id" : "47CDD99C",
    "lastKnownWriteTime" : 1462874181,
    "last_content_update" : 1462874181,
    "path" : "D:/SU/Analyses/Gentiana_phen_2010-2011/selected.R",
    "project_path" : "selected.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}