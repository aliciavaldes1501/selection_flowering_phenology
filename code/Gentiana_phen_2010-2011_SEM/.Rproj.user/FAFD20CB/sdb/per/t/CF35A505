{
    "collab_server" : "",
    "contents" : "#2010 - eggs\n##################################################################################\ndata10 <- read.table(\n  \"data1_2010.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(data10)\nstr(data10)\n\n################################################ Correction phenology\ndates_correction <- read.table(\n  \"dates_correction.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\ndates_correction\ndata10<-merge(data10,subset(dates_correction,year==\"2010\"))\nhead(data10)\nstr(data10)\ndata10$phen_corr<-data10$most_adv+data10$apply_to_phen_1ago\nwith(data10,plot(most_adv,phen_corr))\nwith(data10,hist(most_adv))\nwith(data10,hist(phen_corr))\n######################################################################\n\ndata10_pred<-subset(data10,predator==1&LokalID!=\"GÃ¶t016\")\ndata10_pred$LokalID<-droplevels(data10_pred$LokalID)\ndata10_pred<-data10_pred[complete.cases(data10_pred[6:10]),]\n#Construct new variable: observation-level random effect\ndata10_pred$id<-1:1000\n\nlibrary(lmerTest)\n\nmodeleg10<-glmer.nb(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID),data=data10_pred)\nsummary(modeleg10)\nr.squaredGLMM(modeleg10)\n\nmodeleg10p<-glmer(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID)+(1|id),data=data10_pred,family=\"poisson\")\nsummary(modeleg10p)\nr.squaredGLMM(modeleg10p)\noverdisp.glmer(modeleg10p) #OK!\n\nmodelfr10<-glmer(n_intact_fruits~phen_corr+n_fl+h_shoot+n_eggs+(1|LokalID),data=data10_pred,family=\"poisson\")\nsummary(modelfr10)\nr.squaredGLMM(modelfr10)\noverdisp.glmer(modelfr10) #OK!\n\nlibrary(piecewiseSEM)\nmodel10<-list(\n  glmer(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID)+(1|id),data=data10_pred,family=\"poisson\"),\n  glmer(n_intact_fruits~n_fl+h_shoot+n_eggs+(1|LokalID),data=data10_pred,family=\"poisson\")\n)\n\nsem.fit(model10,data=data10_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model10)\nsem.coefs(model10,data=data10_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#lmer for standardized coefs\nmodel10l<-list(\n  lmer(scale(n_eggs)~scale(most_adv)+scale(n_fl)+scale(h_shoot)+(1|LokalID),data=data10_pred),\n  lmer(scale(n_intact_fruits)~scale(n_fl)+scale(h_shoot)+scale(n_eggs)+(1|LokalID),data=data10_pred)\n  )\nmodel10l<-list(\n  lm(scale(n_eggs)~scale(most_adv)+scale(n_fl)+scale(h_shoot),data=data10_pred),\n  lm(scale(n_intact_fruits)~scale(n_fl)+scale(h_shoot)+scale(n_eggs),data=data10_pred)\n)\nmodel10l<-list(\n  lm(n_eggs~most_adv+n_fl+h_shoot,data=data10_pred),\n  lm(n_intact_fruits~n_fl+h_shoot+n_eggs,data=data10_pred)\n)\nsem.fit(model10l,data=data10_pred,conditional=T,\n        corr.errors=c(\"most_adv~~n_fl\",\"most_adv~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model10l)\nsem.coefs(model10l,data=data10_pred,\n          corr.errors=c(\"most_adv~~n_fl\",\"most_adv~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#2010 - attack\n##################################################################################\n\nmodelat10<-glmer(attack~phen_corr+n_fl+h_shoot+(1|LokalID),data=data10_pred,family=\"binomial\")\nsummary(modelat10)\nr.squaredGLMM(modelat10)\noverdisp.glmer(modelat10) #OK!\n\nmodelfr10a<-glmer(n_intact_fruits~phen_corr+n_fl+h_shoot+attack+(1|LokalID),data=data10_pred,family=\"poisson\")\nsummary(modelfr10a)\nr.squaredGLMM(modelfr10a)\noverdisp.glmer(modelfr10a) #OK!\n\nmodel10a<-list(\n  glmer(attack~phen_corr+n_fl+h_shoot+(1|LokalID),data=data10_pred,family=\"binomial\"),\n  glmer(n_intact_fruits~n_fl+h_shoot+attack+(1|LokalID),data=data10_pred,family=\"poisson\")\n)\n\nsem.fit(model10a,data=data10_pred,conditional=T,\n        corr.errors=c(\"most_adv~~n_fl\",\"most_adv~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model10a)\nsem.coefs(model10a,data=data10_pred,\n          corr.errors=c(\"most_adv~~n_fl\",\"most_adv~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#lmer for standardized coefs\nmodel10la<-list(\n  lmer(scale(attack)~scale(phen_corr)+scale(n_fl)+scale(h_shoot)+(1|LokalID),data=data10_pred),\n  lmer(scale(n_intact_fruits)~scale(n_fl)+scale(h_shoot)+scale(attack)+(1|LokalID),data=data10_pred)\n)\nsem.fit(model10la,data=data10_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model10la)\nsem.coefs(model10la,data=data10_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#2011 - eggs\n##################################################################################\ndata11 <- read.table(\n  \"data1_2011.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(data11)\nstr(data11)\n\n################################################ Correction phenology\ndata11<-merge(data11,subset(dates_correction,year==\"2011\"))\nhead(data11)\nstr(data11)\ndata11$phen_corr<-data11$most_adv+data11$apply_to_phen_1ago\nwith(data11,plot(most_adv,phen_corr))\nwith(data11,hist(most_adv))\nwith(data11,hist(phen_corr))\n######################################################################\n\ndata11_pred<-subset(data11,Predator==1)\ndata11_pred$LokalID<-droplevels(data11_pred$LokalID)\ndata11_pred<-data11_pred[complete.cases(data11_pred[6:10]),]\n#Construct new variable: observation-level random effect\ndata11_pred$id<-1:1099\n\nmodeleg11<-glmer.nb(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID),data=data11_pred)\nsummary(modeleg11)\nr.squaredGLMM(modeleg11)\n\nmodeleg11p<-glmer(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID)+(1|id),data=data11_pred,family=\"poisson\")\nsummary(modeleg11p)\nr.squaredGLMM(modeleg11p)\noverdisp.glmer(modeleg11p) #OK!\n\nmodelfr11<-glmer(n_intact_fruits~phen_corr+n_fl+h_shoot+n_eggs+(1|LokalID),data=data11_pred,family=\"poisson\")\nsummary(modelfr11)\nr.squaredGLMM(modelfr11)\noverdisp.glmer(modelfr11) #OK!\n\nmodel11<-list(\n  glmer(n_eggs~phen_corr+n_fl+h_shoot+(1|LokalID)+(1|id),data=data11_pred,family=\"poisson\"),\n  glmer(n_intact_fruits~phen_corr+n_fl+n_eggs+(1|LokalID),data=data11_pred,family=\"poisson\")\n)\n\nsem.fit(model11,data=data11_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model11)\nsem.coefs(model11,data=data11_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#lmer for standardized coefs\nmodel11l<-list(\n  lmer(scale(n_eggs)~scale(phen_corr)+scale(n_fl)+scale(h_shoot)+(1|LokalID),data=data11_pred),\n  lmer(scale(n_intact_fruits)~scale(phen_corr)+scale(n_fl)+scale(n_eggs)+(1|LokalID),data=data11_pred)\n)\nsem.fit(model11l,data=data11_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model11l)\nsem.coefs(model11l,data=data11_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#2011 - attack\n##################################################################################\n\nmodelat11<-glmer(attack~phen_corr+n_fl+h_shoot+(1|LokalID),data=data11_pred,family=\"binomial\")\nsummary(modelat11)\nr.squaredGLMM(modelat11)\noverdisp.glmer(modelat11) #OK!\n\nmodelfr11a<-glmer(n_intact_fruits~phen_corr+n_fl+h_shoot+attack+(1|LokalID),data=data11_pred,family=\"poisson\")\nsummary(modelfr11a)\nr.squaredGLMM(modelfr11a)\noverdisp.glmer(modelfr11a) #OK!\n\nmodel11a<-list(\n  glmer(attack~phen_corr+n_fl+(1|LokalID),data=data11_pred,family=\"binomial\"),\n  glmer(n_intact_fruits~phen_corr+n_fl+h_shoot+attack+(1|LokalID),data=data11_pred,family=\"poisson\")\n)\n\nsem.fit(model11a,data=data11_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model11a)\nsem.coefs(model11a,data=data11_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n#lmer for standardized coefs\nmodel11la<-list(\n  lmer(scale(attack)~scale(phen_corr)+scale(n_fl)+(1|LokalID),data=data11_pred),\n  lmer(scale(n_intact_fruits)~scale(phen_corr)+scale(n_fl)+scale(h_shoot)+scale(attack)+(1|LokalID),data=data11_pred)\n)\nsem.fit(model11la,data=data11_pred,conditional=T,\n        corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\nsem.model.fits(model11la)\nsem.coefs(model11la,data=data11_pred,\n          corr.errors=c(\"phen_corr~~n_fl\",\"phen_corr~~h_shoot\",\"n_fl~~h_shoot\"))\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1461854776475.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1456281929",
    "id" : "CF35A505",
    "lastKnownWriteTime" : 1463063884,
    "last_content_update" : 1463063885001,
    "path" : "D:/SU/Analyses/Gentiana_phen_2010-2011_SEM/Gentiana_phen_2010-2011_SEM.R",
    "project_path" : "Gentiana_phen_2010-2011_SEM.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}