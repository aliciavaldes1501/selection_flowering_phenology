{
    "collab_server" : "",
    "contents" : "#SEM with lavaan\n#General SEM, one for each study year\n#Using traits standardized within each population\n#predation standardized within each population\n#fitness relativized within each poppulation\n\n#2010\ndata10 <- read.table(\n  \"data1_2010.txt\",\n  header=TRUE, sep=\"\\t\", na.strings=\"NA\", dec=\",\", strip.white=TRUE)\nhead(data10)\nstr(data10)\n\n#Standardize  reproductive traits and n_eggs (and fitness)\n\nmean_h_shoot<-aggregate(h_shoot~LokalID, data10, mean )\nmean_n_fl<-aggregate(n_fl~LokalID, data10, mean )\nmean_most_adv<-aggregate(most_adv~LokalID, data10, mean )\nmean_n_eggs<-aggregate(n_eggs~LokalID, data10, mean )\nmean_n_intact_fruits<-aggregate(n_intact_fruits~LokalID, data10, mean )\nmean_attack<-aggregate(attack~LokalID, data10, mean )\n\n\nsd_h_shoot<-aggregate(h_shoot~LokalID, data10, sd )\nsd_n_fl<-aggregate(n_fl~LokalID, data10, sd )\nsd_most_adv<-aggregate(most_adv~LokalID, data10, sd )\nsd_n_eggs<-aggregate(n_eggs~LokalID, data10, sd )\nsd_n_intact_fruits<-aggregate(n_intact_fruits~LokalID, data10, sd )\nsd_attack<-aggregate(attack~LokalID, data10, sd )\n\ndata10<-merge(data10,mean_h_shoot, by=\"LokalID\")\ndata10<-merge(data10,mean_n_fl, by=\"LokalID\")\ndata10<-merge(data10,mean_most_adv, by=\"LokalID\")\ndata10<-merge(data10,mean_n_eggs, by=\"LokalID\")\ndata10<-merge(data10,mean_n_intact_fruits, by=\"LokalID\")\ndata10<-merge(data10,mean_attack, by=\"LokalID\")\n\nhead(data10)\nnames(data10)\n\nnames(data10)[6:7]<-c(\"h_shoot\",\"n_fl\")\nnames(data10)[9:10]<-c(\"most_adv\",\"n_eggs\")\nnames(data10)[14]<-c(\"n_intact_fruits\")\nnames(data10)[16]<-c(\"attack\")\nnames(data10)[17:22]<-c(\"h_shoot_mean\",\"n_fl_mean\",\"most_adv_mean\",\"n_eggs_mean\",\"n_intact_fruits_mean\",\"attack_mean\")\n\ndata10<-merge(data10,sd_h_shoot, by=\"LokalID\")\ndata10<-merge(data10,sd_n_fl, by=\"LokalID\")\ndata10<-merge(data10,sd_most_adv, by=\"LokalID\")\ndata10<-merge(data10,sd_n_eggs, by=\"LokalID\")\ndata10<-merge(data10,sd_n_intact_fruits, by=\"LokalID\")\ndata10<-merge(data10,sd_attack, by=\"LokalID\")\n\nnames(data10)\nnames(data10)[6:7]<-c(\"h_shoot\",\"n_fl\")\nnames(data10)[9:10]<-c(\"most_adv\",\"n_eggs\")\nnames(data10)[14]<-c(\"n_intact_fruits\")\nnames(data10)[16]<-c(\"attack\")\nnames(data10)[23:28]<-c(\"h_shoot_sd\",\"n_fl_sd\",\"most_adv_sd\",\"n_eggs_sd\",\"n_intact_fruits_sd\",\"attack_sd\")\n\nnames(data10)\n\ndata10$h_shoot_sta<-(data10$h_shoot-data10$h_shoot_mean)/data10$h_shoot_sd\ndata10$n_fl_sta<-(data10$n_fl-data10$n_fl_mean)/data10$n_fl_sd\ndata10$most_adv_sta<-(data10$most_adv-data10$most_adv_mean)/data10$most_adv_sd\ndata10$n_eggs_sta<-(data10$n_eggs-data10$n_eggs_mean)/data10$n_eggs_sd\ndata10$n_intact_fruits_sta<-(data10$n_intact_fruits-data10$n_intact_fruits_mean)/data10$n_intact_fruits_sd\ndata10$attack_sta<-(data10$attack-data10$attack_mean)/data10$attack_sd\n\n\nsummary(data10,by=\"LokalID\")\naggregate(h_shoot_sta~LokalID, data10, sd )\naggregate(n_fl_sta~LokalID, data10, sd )\naggregate(most_adv_sta~LokalID, data10, sd )\naggregate(n_eggs_sta~LokalID, data10, sd )\naggregate(n_intact_fruits_sta~LokalID, data10, sd )\naggregate(attack_sta~LokalID, data10, sd )\n\n#Relativize fitness\n\ndata10$n_intact_fruits_rel<-data10$n_intact_fruits/data10$n_intact_fruits_mean\naggregate(n_intact_fruits_rel~LokalID, data10, mean )\n\n\n# Model 2010, eggs\n\nlibrary(lavaan)\n\ndata10_pred<-subset(data10,predator==1&LokalID!=\"GÃ¶t016\")\ndata10_pred$LokalID<-droplevels(data10_pred$LokalID)\ndata10_pred<-data10_pred[complete.cases(data10_pred[6:10]),]\n\n#Traits and eggs standardized within populations,\n#fitness relativized wthing populations\nmodel10lavaan<-'n_eggs_sta ~ most_adv_sta + n_fl_sta + h_shoot_sta \n                n_intact_fruits_rel ~ n_fl_sta + h_shoot_sta + n_eggs_sta\n                most_adv_sta ~~ n_fl_sta\n                most_adv_sta ~~ h_shoot_sta\n                n_fl_sta ~~ h_shoot_sta'\n\nsummary(sem(model10lavaan, data=data10_pred,std.ov=F,fixed.x=F,estimator=\"MLM\"),\n        standardized = T,fit.measures=T,rsquare=T)\n#p<0.05\n\n#All variables standardized accross populations\nmodel10lavaan<-'n_eggs ~ most_adv + n_fl + h_shoot \n                n_intact_fruits ~  most_adv + n_fl + n_eggs\n                most_adv ~~ n_fl\n                most_adv ~~ h_shoot\n                n_fl ~~ h_shoot'\n\nsummary(sem(model10lavaan, data=data10_pred,std.ov=F,fixed.x=F,estimator=\"MLM\"),\n        standardized = T,fit.measures=T,rsquare=T)\n#p=0.074/0.062 with MLM\n\n#All variables standardized within populations\nmodel10lavaan<-'n_eggs_sta ~ most_adv_sta + n_fl_sta\n                n_intact_fruits_sta ~ most_adv_sta + n_fl_sta + h_shoot_sta + n_eggs_sta\n                most_adv_sta ~~ n_fl_sta\n                most_adv_sta ~~ h_shoot_sta\n                n_fl_sta ~~ h_shoot_sta'\n\nsummary(sem(model10lavaan, data=data10_pred,std.ov=F,fixed.x=F,estimator=\"MLM\"),\n        standardized = T,fit.measures=T,rsquare=T)\n#p<0.360/0.418 with MLM! --> OK?\n",
    "created" : 1463063819186.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4234778303",
    "id" : "74620260",
    "lastKnownWriteTime" : 1463491998,
    "last_content_update" : 1463491998666,
    "path" : "D:/SU/Analyses/Gentiana_phen_2010-2011_SEM/SEM_lavaan.R",
    "project_path" : "SEM_lavaan.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}